@page "/recipes/create"
@rendermode InteractiveServer
@using Recipe_Sharing_Website.Models
@inject Recipe_Sharing_Website.Data.AppDbContext Db
@inject NavigationManager Nav

<h3>Add Recipe</h3>

<EditForm Model="_model" OnValidSubmit="CreateAsync" FormName="CreateRecipeForm">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label>Title</label>
        <InputText class="form-control" @bind-Value="_model.Title" />
    </div>

    <div class="mb-3">
        <label>Description</label>
        <InputTextArea class="form-control" @bind-Value="_model.Description" />
    </div>

    <div class="mb-3">
        <label>Category</label>
        <InputText class="form-control" @bind-Value="_model.Category" />
    </div>

    <div class="mb-3">
        <label>Cook Time (minutes)</label>
        <InputNumber class="form-control" @bind-Value="_model.CookTimeMinutes" />
    </div>

    <div class="mb-3">
        <label>Steps</label>
        <InputTextArea class="form-control" @bind-Value="_model.StepsText" />
    </div>

    <button class="btn btn-success" type="submit">Create</button>
</EditForm>

@code {
    private Recipe _model = new() { Category = "General" };

    private async Task CreateAsync()
    {
        _model.UserId = 1;
        Db.Recipes.Add(_model);
        await Db.SaveChangesAsync();
        Nav.NavigateTo("/recipes");
    }
}
