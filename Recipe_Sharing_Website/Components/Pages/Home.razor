@* Route for the home page *@
@page "/"

@* Import data/session helpers *@
@using Recipe_Sharing_Website.Data

@* Inject HttpContext accessor to read session *@
@inject IHttpContextAccessor HttpContextAccessor

@* Inject NavigationManager for redirection *@
@inject NavigationManager Nav

@* Main landing page heading *@
<h1>RecipeHub</h1>

@* If the user is not logged in, show login/register options *@
@if (!IsLoggedIn)
{
    <p>You must be logged in to use RecipeHub.</p>

    <a class="btn btn-primary" href="/login">Login</a>
    <a class="btn btn-outline-secondary ms-2" href="/register">Register</a>
}
@* If logged in, show quick navigation links *@
else
{
    <p>Welcome to RecipeHub.</p>

    <ul>
        <li><a href="/recipes">Browse Recipes</a></li>
        <li><a href="/recipes/create">Create Recipe</a></li>
        <li><a href="/premium">Premium</a></li>

        @* Extra links for admin users *@
        @if (IsAdmin)
        {
            <li><a href="/admin">Admin Panel</a></li>
        }

        <li><a href="/logout">Logout</a></li>
    </ul>
}

@code {
    // True if user is logged in (based on session)
    private bool IsLoggedIn =>
        HttpContextAccessor.HttpContext is HttpContext ctx &&
        AuthSession.IsLoggedIn(ctx.Session);

    // True if user has admin privileges
    private bool IsAdmin =>
        HttpContextAccessor.HttpContext is HttpContext ctx &&
        AuthSession.IsAdmin(ctx.Session);

    // On page load, optionally redirect non-logged-in users
    protected override void OnInitialized()
    {
        if (!IsLoggedIn)
        {
            Nav.NavigateTo("/login");
        }
    }
}

