@using Recipe_Sharing_Website.Data
@inject IHttpContextAccessor HttpContextAccessor

<nav class="nav flex-column p-3">
    <NavLink class="nav-link" href="/" Match="NavLinkMatch.All">Home</NavLink>
    <NavLink class="nav-link" href="/recipes">Recipes</NavLink>

    @if (IsLoggedIn)
    {
        <NavLink class="nav-link" href="/recipes/create">Add Recipe</NavLink>
        <NavLink class="nav-link" href="/my-recipes">My Recipes</NavLink>
        <NavLink href="/profile">Profile</NavLink>

        @if (IsAdmin)
        {
            <NavLink class="nav-link" href="/admin">Admin</NavLink>
        }

        <NavLink class="nav-link" href="/logout">Logout</NavLink>

        @if (!string.IsNullOrWhiteSpace(LoggedInName))
        {
            <div class="mt-2 small text-muted">
                Logged in as: <b>@LoggedInName</b>
            </div>
        }
    }
    else
    {
        <NavLink class="nav-link" href="/login">Login</NavLink>
        <NavLink class="nav-link" href="/register">Register</NavLink>
    }
</nav>

@code {
    private bool IsLoggedIn =>
        HttpContextAccessor.HttpContext is HttpContext ctx &&
        AuthSession.IsLoggedIn(ctx.Session);

    private bool IsAdmin =>
        HttpContextAccessor.HttpContext is HttpContext ctx &&
        AuthSession.IsAdmin(ctx.Session);

    private string? LoggedInName =>
        HttpContextAccessor.HttpContext?.Session.GetString(AuthSession.NameKey);
}
